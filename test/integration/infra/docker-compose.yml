version: "3.7"
# SPDX-FileCopyrightText: 2022-present Open Networking Foundation
# SPDX-License-Identifier: Apache-2.0

services:
  pfcpiface:
    build:
      context: ../../../
      dockerfile: Dockerfile
      target: pfcpiface
    hostname: pfcpiface
    container_name: pfcpiface
    tty: true
    stdin_open: true
    volumes:
      - ../config/:/config/
    entrypoint: "/bin/sh"
    working_dir: /bin/
    ports:
      - "8805:8805/udp"
    expose:
      - 8805
    depends_on:
      - mock-up4
  mock-up4:
    image: opennetworking/p4mn:latest@sha256:cfcaca89d1a33371a6c2c4ee285e58d884ef01ea05072b6425eb03a3c94c4d7c
    hostname: mock-up4
    container_name: mock-up4
    privileged: true
    tty: true
    stdin_open: true
    ports:
      - "50001:50001" # P4Runtime server
    command: [ "--topo", "single"]
    expose:
      - 50001