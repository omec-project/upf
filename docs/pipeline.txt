                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :4 0 0:
  +---------------------------------------------------------------------------------------------------------------------------------------------+                                                                                                                                                                                                                                                                                                               +---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
  |                                                                                                                                             |                                                                                                                                                                                                                                                                                                               v                                                                                                                                                                                                                                                                                                                                                                                             |
  |                                                                                                      +-------------------+                  |                                                                                                                                                                                                                                                                                                             +----------------+                                                                    +--------------+                                                                                                              +-------------+                                                                                                                                                             |
  |                                                                                                      |      sink20       |                  |                                                                                                                                                                                                                                                                                                             |  FARNotifyCP   |                                                                    |    sink2     |                                                                                                              |    sink3    |                                                                                                                                                             |
  |                                                                                                      |       Sink        | <+               |                                                                                                                                                                                                                                                                                                             |      Sink      |                                                                    |     Sink     |                                                                                                              |    Sink     |                                                                                                                                                             |
  |                                                                                                      +-------------------+  |               |                                                                                                                                                                                                                                                                                                             +----------------+                                                                    +--------------+                                                                                                              +-------------+                                                                                                                                                             |
  |                                                                                                                             |               |                                                                                                                                                                                                                                                                                                                                                                                                     ^                                                                                                                             ^                                                                                                                                                                         |
  |                                                                                                                             |               |                                                                                                                                                                                                                                                                                                                                                                                                     | :8191 0 0:                                                                                                                  | :0 0 0:                                                                                                                                                                 |
  |                                                                                                                             |               |                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                                             |                                                                                                                                                                         |
  |                                                                     +---------------+                +-------------------+  |               |                              +-------------------+            +--------------+                                                                                          +------------+            +------------------------+                                          +------------------------+            +----------------+            +--------------+            +--------------+            +--------------+            +-----------------------------+            +--------------+            +-------------+            +-------------+            +-----------------------------+            +-----------------+                                                                                   |
  |                                                                     |  s1uQSlowPO   |                |     s1uSlowPO     |  | :1 0 0:       |                              |      sink19       |            |    sink15    |                                                                                          |   sink4    |            |         sink5          |                                          |         sink6          |            | EtherDecapTrim |            |  GTPUDecap   |            | SGIEtherAdd  |            |  sgiRoutes   |            | sgiRoutesDstMAC6805CA37DFD2 |            |   sgiMerge   |            |  measure1   |            | sgiIP4Frag  |            |          sgiFastPO          |            |    sgiSlowPI    |                                                                                   |
  |                                                                     |     Queue     |  :0 0 0:       |      PortOut      |  |               |                              |       Sink        |            |     Sink     |                                                                                          |    Sink    |            |          Sink          |                                          |          Sink          |            |  GenericDecap  |  :0 0 0:   |  GtpuDecap   |  :0 0 0:   | GenericEncap |  :0 0 0:   |   IPLookup   |  :0 0 0:   |           Update            |  :0 0 0:   |    Merge     |  :0 0 0:   |   Measure   |  :0 0 0:   |   IPFrag    |  :1 0 0:   |           PortOut           |  :0 0 0:   |     PortInc     |                                                                                   |
  |                                                                     |    0/1024     | -------------> |  s1uSlow/PMDPort  |  |               |                              |                   |            |              |                                                                                          |            |            |                        |                                          |                        |            |                | ---------> |              | ---------> |              | ---------> |              | ---------> |                             | ---------> |              | ---------> |             | ---------> |             | ---------> |       sgiFast/PMDPort       | <--------- | sgiSlow/PMDPort |                                                                                   |
  |                                                                     +---------------+                +-------------------+  |               |                              +-------------------+            +--------------+                                                                                          +------------+            +------------------------+                                          +------------------------+            +----------------+            +--------------+            +--------------+            +--------------+            +-----------------------------+            +--------------+            +-------------+            +-------------+            +-----------------------------+            +-----------------+                                                                                   |
  |                                                                       ^                                                     |               |                                ^                                ^                                                                                                         ^                         ^                                                                   ^                                     ^                                                                                                                                                                                                                                                                                                                                                                                             |
  |                                                                       | :8191 0 0:                     +--------------------+               |                                | :1 11693 0:                    | :0 0 0:                                                                                                 | :0 0 0:                 | :0 0 0:                                                           | :0 0 0:                             | :0 0 0:                                                                                                                                                    +--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----+
  |                                                                       |                                |                                    |                                |                                |                                                                                                         |                         |                                                                   |                                     |                                                                                                                                                            |                                                                                                                                                                                                                                |    |
  |  +-----------------+                +--------------+                +---------------+                +-------------------+                +---------------+                +-------------------+            +--------------+            +------------+            +-------------+            +-----------+            +------------+            +------------------------+            +----------------+            +------------------------+            +----------------+            +--------------+            +--------------+            +--------------+            +-----------------------------+            +--------------+            +-------------+            +-------------+            +-----------------------------+            +-----------------+            +----------+            +------------+            +-----------------+  |    |              +-----------------+
  |  |    s1uFastPI    |                |  timestamp0  |                |  s1uFastBPF   |                |   s1uRxIPCksum    |                | s1uRxUDPCksum |                |   ULMACDstMatch   |            | s1uIP4Defrag |            | InetLookup |            |  setattr1   |            | LinkMerge |            |  PktParse  |            |       PDRLookup        |            | PreQoSCounter  |            |       FARLookup        |            |                |            |  EtherTrim   |            |  GTPUEncap   |            | S1UEtherAdd  |            |       PostQoSCounter        |            | OuterUDPCsum |            | OuterIPCsum |            |  s1uRoutes  |            | s1uRoutesDstMAC6805CA37DFD1 |            |    s1uMerge     |            | measure0 |            | s1uIP4Frag |            |    s1uFastPO    |  |    |              |    s1uSlowPI    |
  |  |     PortInc     |  :0 11693 0:   |  Timestamp   |  :0 11693 0:   |      BPF      |  :0 11693 0:   |    IPChecksum     |  :0 11693 0:   |  L4Checksum   |  :0 11693 0:   |    ExactMatch     |  :0 0 0:   |   IPDefrag   |  :1 0 0:   |  IPLookup  |  :0 0 0:   | SetMetadata |  :0 0 0:   |   Merge   |  :0 0 0:   | GtpuParser |  :1 0 0:   |     WildcardMatch      |  :1 0 0:   |    Counter     |  :0 0 0:   |       ExactMatch       |  :1 0 0:   |                |  :1 0 0:   | GenericDecap |  :0 0 0:   |  GtpuEncap   |  :1 0 0:   | GenericEncap |  :0 0 0:   |           Counter           |  :0 0 0:   |  L4Checksum  |  :0 0 0:   | IPChecksum  |  :0 0 0:   |  IPLookup   |  :0 0 0:   |           Update            |  :0 0 0:   |      Merge      |  :0 0 0:   | Measure  |  :0 0 0:   |   IPFrag   |  :1 0 0:   |     PortOut     |  |    |   :0 0 0:    |     PortInc     |
  |  | s1uFast/PMDPort | -------------> |              | -------------> |               | -------------> |                   | -------------> |               | -------------> | 1 fields, 1 rules | ---------> |              | ---------> |            | ---------> |             | ---------> |           | ---------> |            | ---------> | 8 fields, 100000 rules | ---------> | 50000 sessions | ---------> | 2 fields, 100000 rules | ---------> |                | ---------> |              | ---------> |              | ---------> |              | ---------> |       50000 sessions        | ---------> |              | ---------> |             | ---------> |             | ---------> |                             | ---------> |                 | ---------> |          | ---------> |            | ---------> | s1uFast/PMDPort | <+----+------------- | s1uSlow/PMDPort |
  |  +-----------------+                +--------------+                +---------------+                +-------------------+                +---------------+                +-------------------+            +--------------+            +------------+            +-------------+            +-----------+            +------------+            +------------------------+            +----------------+            +------------------------+            |                |            +--------------+            +--------------+            +--------------+            +-----------------------------+            +--------------+            +-------------+            +-------------+            +-----------------------------+            +-----------------+            +----------+            +------------+            +-----------------+  |    |              +-----------------+
  |                                                                       |                                                                                                                                                                                                                        ^                                                                                                                                                          |   ExecuteFAR   |                                          |                                                                                                  ^                           |                          |                                                                                                                            |                                            |    |
  |                                                                       | :1 0 0:                                                                                                                                                                                                                | :0 0 0:                                                                                                                                                  |     Split      | -----------------------------------------+--------------------------------------------------------------------------------------+           | :0 0 1:                   |                          |                                                                                                                            |                                            |    |
  |                                                                       v                                                                                                                                                                                                                        |                                                                                                                                                          |                |                                          |                                                                                      |           |                           |                          |                                                                                                                            |                                            |    |
  |  +-----------------+                +--------------+                +---------------+                +-------------------+                +---------------+                +-------------------+                                                                                               |                                                                                                                                                          |                |                                          |                                                                                      |           |                           |                          |                                                                                                                            |                                            |    |
  |  |    sgiFastPI    |                |  timestamp1  |                | gtpRxIPCksum  |                |   gtpRxUDPCksum   |                |   GTPUEcho    |                |      EthSwap      |                                                                                               |                                                                                                                                                          |                |                                          |                                                                                      |           |                           |                          |                                                                                                                            |                                            |    |
  |  |     PortInc     |  :0 11692 0:   |  Timestamp   |                |  IPChecksum   |  :0 0 0:       |    L4Checksum     |  :0 0 0:       |   GtpuEcho    |  :1 0 0:       |      MACSwap      |                                                                                               |                                                                                                                                                          |                |                                          |                                                                                      |           |                           |                          |                                                                                                                            |                                            |    |
  |  | sgiFast/PMDPort | -------------> |              |                |               | -------------> |                   | -------------> |               | -------------> |                   | ----------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+         |                | -+                                       |                                                                                      +-----------+---------------------------+--------------------------+----------------------------------------------------------------------------------------------------------------------------+--------------------------------------------+    |
  |  +-----------------+                +--------------+                +---------------+                +-------------------+                +---------------+                +-------------------+                                                                                               |                                                                                                                                                |         +----------------+  |                                       |                                                                                                  |                           |                          |                                                                                                                            |                                                 |
  |                                       |                               |                                |                                    |                                                                                                                                                  |                                                                                                                                                |                             |                                       |                                                                                                  |                           |                          |                                                                                                                            |                                                 |
  |                                       | :0 11692 0:                   | :1 0 0:                        | :1 0 0:                            | :0 0 0:                                                                                                                                          |                                                                                                                                                +-----------------------------+---------------------------------------+--------------------------------------------------------------------------------------------------+                           |                          |                                                                                                                            |                                                 |
  |                                       v                               v                                v                                    v                                                                                                                                                  |                                                                                                                                                                              |                                       |                                                                                                                              |                          |                                                                                                                            |                                                 |
  |  +-----------------+                +--------------+                +---------------+                +-------------------+                +---------------+                                                                                                                                    |                                                                                                                                                                              |                                       |                                                                                                                              |                          |                                                                                                                            |                                                 |
  |  |   sgiQSlowPO    |                |  sgiFastBPF  |                |    sink17     |                |      sink18       |                |    sink16     |                                                                                                                                    |                                                                                                                                                                              |                                       |                                                                                                                              |                          |                                                                                                                            |                                                 |
  |  |      Queue      |  :8191 0 0:    |     BPF      |                |     Sink      |                |       Sink        |                |     Sink      |                                                                                                                                    |                                                                                                                                                                              |                                       | :0 0 0:                                                                                                                      |                          |                                                                                                                            |                                                 |
  |  |     0/1024      | <------------- |              |                |               |                |                   |                |               |                                                                                                                                    |                                                                                                                                                                              |                                       |                                                                                      +---------------------------------------+                          |                                                                                                                            |                                                 |
  |  +-----------------+                +--------------+                +---------------+                +-------------------+                +---------------+                                                                                                                                    |                                                                                                                                                                              | :2 0 0:                               v                                                                                      |                                                                  |                                                                                                                            |                                                 |
  |    |                                  |                                                                                                                                                                                                                                                        |                                                                                                                                                                              |                                     +--------------+                                                                         |         +--------------+                                         |                                                                                                                            |                                                 |
  |    |                                  |                                                                                                                                                                                                                                                        |                                                                                                                                                                              |                                     |    sink8     |                                                                         |         |    sink12    |  :1 0 0:                                |                                                                                                                            |                                                 |
  |    | :0 0 0:                          | :0 11692 0:                                                                                                                                                                                                                                            |                                                                                                                                                                              |                                     |     Sink     |                                                                         |         |     Sink     | <---------------------------------------+----------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------+
  |    v                                  v                                                                                                                                                                                                                                                        |                                                                                                                                                                              |                                     +--------------+                                                                         |         +--------------+                                         |                                                                                                                            |
  |  +-----------------+                +--------------+                +---------------+                +-------------------+                +---------------+                +-------------------+            +--------------+                                                                   |                                                                                                                                                          +----------------+  |                                                                                                                              |                                                                  |                                                                                                                            |
  |  |    sgiSlowPO    |                | sgiRxIPCksum |                | sgiRxUDPCksum |                |   DLMACDstMatch   |                | sgiIP4Defrag  |                |     ueLookup      |            |   setattr0   |                                                                   |                                                                                                                                                          |    FARDrop     |  |                                                                                                                              |                                                                  |                                                                                                                            |
  |  |     PortOut     |                |  IPChecksum  |  :0 11692 0:   |  L4Checksum   |  :0 11692 0:   |    ExactMatch     |  :0 0 0:       |   IPDefrag    |  :1 0 0:       |     IPLookup      |  :0 0 0:   | SetMetadata  |                                                                   |                                                                                                                                                          |      Sink      |  |                                                                                                                              |                                                                  |                                                                                                                            |
  |  | sgiSlow/PMDPort |                |              | -------------> |               | -------------> | 1 fields, 1 rules | -------------> |               | -------------> |                   | ---------> |              | ------------------------------------------------------------------+                                                                                                                                                          |                | <+                                                                                                                              |                                                                  |                                                                                                                            |
  |  +-----------------+                +--------------+                +---------------+                +-------------------+                +---------------+                +-------------------+            +--------------+                                                                                                                                                                                                                              +----------------+                                                                                                                                 |                                                                  |                                                                                                                            |
  |                                       |                               |                                |                                    |                                |                                                                                                                                                                                                                                                                                                                                                                                                                               |                                                                  |                                                                                                                            |
  |                                       | :1 0 0:                       | :1 0 0:                        | :1 11692 0:                        | :0 0 0:                        | :8191 0 0:                                                                                                                                                                                                                                                                                                                                                                                                                    |                                                                  | :8191 0 0:                                                                                                                 | :0 0 0:
  |                                       v                               v                                v                                    v                                v                                                                                                                                                                                                                                                                                                                                                                                                                               |                                                                  v                                                                                                                            v
  |                                     +--------------+                +---------------+                +-------------------+                +---------------+                +-------------------+                                                                                                                                                                                                                                                                                                                                                                                                             |                                     +-------------+            +-------------+                                                                                                              +------------+
  |                                     |    sink9     |                |    sink10     |                |      sink13       |                |     sink7     |                |      sink14       |                                                                                                                                                                                                                                                                                                                                                                                                             |                          :1 0 0:    |   sink11    |            |    sink0    |                                                                                                              |   sink1    |
  |                                     |     Sink     |                |     Sink      |                |       Sink        |                |     Sink      |                |       Sink        |                                                                                                                                                                                                                                                                                                                                                                                                             +-----------------------------------> |    Sink     |            |    Sink     |                                                                                                              |    Sink    |
  |                                     +--------------+                +---------------+                +-------------------+                +---------------+                +-------------------+                                                                                                                                                                                                                                                                                                                                                                                                                                                   +-------------+            +-------------+                                                                                                              +------------+
  |                                                                                                                                           +---------------+
  |                                                                                                                            :1 0 0:        |    sink21     |
  +-----------------------------------------------------------------------------------------------------------------------------------------> |     Sink      |
                                                                                                                                              +---------------+
